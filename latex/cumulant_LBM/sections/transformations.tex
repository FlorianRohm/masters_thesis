% !TEX root = ../main.tex

\subsection{Cumulants from moments}
\label{sub:Cumulants from moments}

We seek a representation of the cumulants $\kappa_{\alpha\beta}$ in terms of moments, as the later ones are much more easy to compute, cf.~\eqref{eq:Definition of moments}. This link can be established with the chain rule for differentiaton.
From~\eqref{eq:alternative representation of moments} and~\eqref{eq:Definition of cumulants} follows
\begin{equation}
  \label{eq:definition of kappa_00}
  \kappa_{00} = \ln(F(0,0)) = \ln(m_{00}) = \ln(\rho).
\end{equation}
For brevity, the following notations are introduced
\begin{equation}
  \label{eq:abbreviations for deriving cumulants from moments}
  \begin{aligned}
    F & \defined F(\Xi_1, \Xi_2) \\
    \Xi &\defined \begin{pmatrix}\Xi_1 \\ \Xi_2  \end{pmatrix} \\
    \partial_i &\defined \frac{\partial}{\partial \Xi_i}
  \end{aligned}
\end{equation}

\subsubsection{Cumulants from moments}
\label{subs:Cumulants from moments}

\begin{equation*}
  \begin{aligned}
    \kappa_{10} & = {(-c)}^{-1} \left.\partial_1 \ln(F) \right|_{\Xi = 0} \\
    & = {(-c)}^{-1} \left. \frac{1}{F} \partial_1 F \right|_{\Xi = 0} \\
    & = \frac{m_{10}}{m_{00}}
  \end{aligned}
\end{equation*}
The cumulant $\kappa_{01}$ follows from symmetrie and is listed in~\ref{subs:Listing the cumulants from moments}

\begin{align*}
  \phantom{\kappa_{00}}
  &\begin{aligned}
  \nonumber
    \mathllap{\kappa_{11}} & = {(-c)}^{-2} \left.\partial_1 \partial_2 \ln(F) \right|_{\Xi = 0} \\
    & = {(-c)}^{-2} \left.\partial_2 \left( \frac{1}{F} \partial_1 F \right) \right|_{\Xi = 0} \\
    & = {(-c)}^{-2} \left.\left( -\frac{1}{F^2} \partial_2 F \partial_1 F + \frac{1}{F} \partial_1\partial_2 F \right) \right|_{\Xi = 0} \\
    & = {(-c)}^{-2} \left(
      - \frac{1}{m_{00}} \frac{m_{01}}{{(-c)}^{-1}} \frac{m_{10}}{{(-c)}^{-1}}
      + \frac{1}{m_{00}} \frac{m_{11}}{{(-c)}^{-2}}
      \right) \\
    & = \frac{m_{11}}{m_{00}} - \frac{m_{10}m_{01}}{m_{00}^2}
  \end{aligned} \\
  \\
  &\begin{aligned}
  \nonumber
  \mathllap{\kappa_{20}} & = {(-c)}^{-2} \left.\partial_1^2 \ln(F) \right|_{\Xi = 0} \\
  & = {(-c)}^{-2} \left.\partial_1 \left( \frac{1}{F} \partial_1 F \right) \right|_{\Xi = 0} \\
  & = {(-c)}^{-2} \left.\left( -\frac{1}{F^2} {(\partial_1 F)}^2 + \frac{1}{F} \partial_1^2 F \right) \right|_{\Xi = 0} \\
  & = {(-c)}^{-2} \left(
    - \frac{1}{m_{00}^2} \frac{m_{10}^2}{{(-c)}^{-2}}
    + \frac{1}{m_{00}} \frac{m_{20}}{{(-c)}^{-2}}
    \right)\\
  & = \frac{m_{20}}{m_{00}} - \frac{m_{10}^2}{m_{00}^2}
  \end{aligned} \\
  \\
  &\begin{aligned}
  \nonumber
  \mathllap{\kappa_{21}} & = {(-c)}^{-3} \left. \partial_2 \partial_1^2 \ln(F) \right|_{\Xi = 0} \\
  & = {(-c)}^{-3} \left.\left(\partial_2\left( -\frac{1}{F^2} {(\partial_1 F)}^2 + \frac{1}{F} \partial_1^2 F \right)\right) \right|_{\Xi = 0} \\
  & = {(-c)}^{-3} \left.\left(
      \frac{2}{F^3} \partial_2 F {(\partial_1 F)}^2
    - \frac{2}{F^2} \partial_1 F \partial_1 \partial_2 F
    - \frac{1}{F^2} \partial_2 F \partial_1^2 F
    + \frac{1}{F} \partial_2 \partial_1^2 F
    \right)\right|_{\Xi = 0}\\
  & = {(-c)}^{-3} \Bigg(
      \frac{2}{m_{00}^3} \frac{m_{01}}{{(-c)}^{-1}} \frac{m_{10}^2}{{(-c)}^{-2}}
    - \frac{2}{m_{00}^2} \frac{m_{10}}{{(-c)}^{-1}} \frac{m_{11}}{{(-c)}^{-2}}
    \\ &\qquad\qquad
    - \frac{1}{m_{00}^2} \frac{m_{01}}{{(-c)}^{-1}} \frac{m_{20}}{{(-c)}^{-2}}
    + \frac{1}{m_{00}}   \frac{m_{21}}{{(-c)}^{-3}}
    \Bigg)\\
  & = \frac{m_{21}}{m_{00}} - \frac{m_{20}m_{01}}{m_{00}^2}
       - 2\frac{m_{10}m_{11}}{m_{00}^2} + 2\frac{m_{10}^2 m_{01}}{m_{00}^3}
  \end{aligned}\\
  \\
  &\begin{aligned}
  \nonumber
  \mathllap{\kappa_{22}} & = {(-c)}^{-4} \left. \partial_2^2 \partial_1^2 \ln(F) \right|_{\Xi = 0} \\
  & = {(-c)}^{-3} \Bigg(\partial_2\Big(
      \frac{2}{F^3} \partial_2 F {(\partial_1 F)}^2
    - \frac{2}{F^2} \partial_1 F \partial_1 \partial_2 F \\
    &\qquad\qquad\qquad
    - \frac{1}{F^2} \partial_2 F \partial_1^2 F
    + \frac{1}{F} \partial_2 \partial_1^2 F
    \Big)\Bigg)\Bigg|_{\Xi = 0}\\
  %
  & = {(-c)}^{-4} \bigg(
    - \frac{6}{F^4} {(\partial_2 F)}^2 {(\partial_1 F)}^2
    + \frac{2}{F^3} \partial_2^2 F {(\partial_1 F)}^2
    + \frac{4}{F^3} \partial_1 F \partial_2 F \partial_1 \partial_2 F \\
  & \qquad\qquad\quad
    + \frac{4}{F^3} \partial_1 F \partial_2 F \partial_1 \partial_2 F
    - \frac{2}{F^2} {(\partial_1 \partial_2 F)}^2
    - \frac{2}{F^2} \partial_1 F \partial_1 \partial_2^2 F \\
  & \qquad\qquad\quad
    + \frac{2}{F^3} {(\partial_2 F)}^2  \partial_1^2 F
    - \frac{1}{F^2} \partial_1^2 F \partial_2^2 F
    - \frac{1}{F^2} \partial_2 F \partial_2 \partial_1^2 F \\
  & \qquad\qquad\quad
    - \frac{1}{F^2} \partial_2 F \partial_2 \partial_1^2 F
    + \frac{1}{F}   \partial_1^2 \partial_2^2 F
    \bigg)\bigg|_{\Xi = 0} \\
  %
  & = -\frac{6}{m_{00}^4} m_{10}^2 m_{01}^2 \\
  &\quad
    + \frac{1}{m_{00}^3}
      \left(
        2 m_{10}^2 m_{02} + 4 m_{10}m_{11}m_{01}
        + 4 m_{10}m_{11}m_{01} + 2 m_{20}m_{01}^2
      \right) \\
  &\quad
    - \frac{1}{m_{00}^2}
      \left(
        2 m_{11}^2 + 2 m_{10}m_{12} + m_{20}m_{02} + m_{21}m_{01} + m_{21}m_{01}
      \right) \\
  &\quad
    + \frac{1}{m_{00}} m_{22}\\
  %
  & = \frac{1}{m_{00}} m_{22} \\
    &\quad
    - \frac{1}{m_{00}^2}
    \left(
       2 m_{10}m_{12}  + 2 m_{21}m_{01} + 2 m_{11}^2 + m_{20}m_{02}
    \right) \\
    &\quad
    + \frac{2}{m_{00}^3}
      \left(
        m_{10}^2 m_{02} + 4 m_{10}m_{11}m_{01} + m_{20}m_{01}^2
      \right)\\
    &\quad
       - \frac{6}{m_{00}^4} m_{10}^2 m_{01}^2
  \end{aligned}
\end{align*}

\subsubsection{Listing the cumulants from moments}
\label{subs:Listing the cumulants from moments}
\begin{align}
  \kappa_{00} & = \ln(m_{00}) \\
  \kappa_{10} & = \frac{m_{10}}{m_{00}} \\
  \kappa_{01} & = \frac{m_{01}}{m_{00}} \\
  \kappa_{11} & = \frac{m_{11}}{m_{00}} - \frac{m_{10}m_{01}}{m_{00}^2} \\
  \kappa_{20} & = \frac{m_{20}}{m_{00}} - \frac{m_{10}^2}{m_{00}^2} \\
  \kappa_{02} & = \frac{m_{02}}{m_{00}} - \frac{m_{01}^2}{m_{00}^2} \\
  \kappa_{21} & = \frac{m_{21}}{m_{00}} - \frac{m_{20}m_{01}}{m_{00}^2}
       - 2\frac{m_{10}m_{11}}{m_{00}^2} + 2\frac{m_{10}^2 m_{01}}{m_{00}^3} \\
  \kappa_{12} & = \frac{m_{12}}{m_{00}} - \frac{m_{10}m_{02}}{m_{00}^2}
       - 2\frac{m_{11}m_{01}}{m_{00}^2} + 2\frac{m_{10} m_{01}^2}{m_{00}^3} \\
  \kappa_{22} & = \frac{1}{m_{00}} m_{22} \\
    &\quad
    - \frac{1}{m_{00}^2}
    \left(
       2 m_{10}m_{12}  + 2m_{21}m_{01} + 2 m_{11}^2 + m_{20}m_{02}
    \right) \\
    &\quad
    + \frac{2}{m_{00}^3}
      \left(
        m_{10}^2 m_{02} + 4 m_{10}m_{11}m_{01} + m_{20}m_{01}^2
      \right)\\
    &\quad
    - \frac{6}{m_{00}^4} m_{10}^2 m_{01}^2
\end{align}
For more convenient reading, the normalized cumulants
\begin{equation}
  \label{eq: definition normalized cumulants}
  K_{\alpha\beta} \defined m_{00}\kappa_{\alpha\beta},
\end{equation}
are introduced.

\begin{align}
  K_{00} & = \ln(m_{00})m_{00} \label{eq: K 00 from moments}\\
  K_{10} & = m_{10} \label{eq: K 10 from moments}\\
  K_{01} & = m_{01} \label{eq: K 01 from moments}\\
  K_{11} & = m_{11} - \frac{m_{10}m_{01}}{m_{00}} \label{eq: K 11 from moments} \\
  K_{20} & = m_{20} - \frac{m_{10}^2}{m_{00}} \label{eq: K 20 from moments}\\
  K_{02} & = m_{02} - \frac{m_{01}^2}{m_{00}} \label{eq: K 02 from moments}\\
  K_{21} & = m_{21} - \frac{m_{20}m_{01}}{m_{00}}
       - 2\frac{m_{10}m_{11}}{m_{00}} + 2\frac{m_{10}^2 m_{01}}{m_{00}^2} \label{eq: K 21 from moments}\\
  K_{12} & = m_{12} - \frac{m_{10}m_{02}}{m_{00}}
       - 2\frac{m_{11}m_{01}}{m_{00}} + 2\frac{m_{10} m_{01}^2}{m_{00}^2} \label{eq: K 12 from moments}\\
  K_{22} & = m_{22} \\
       & \quad - 2 \frac{m_{10}m_{12}}{m_{00}} - 2\frac{m_{21}m_{01}}{m_{00}}
        - 2 \frac{m_{11}^2}{m_{00}} - \frac{m_{20}m_{02}}{m_{00}} \\
       & \quad + 2 \frac{m_{10}^2 m_{02}}{m_{00}^2} + 8 \frac{m_{10}m_{11}m_{01}}{m_{00}^2}
        + 2 \frac{m_{20}m_{01}^2}{m_{00}^2} \\
       & \quad - 6 \frac{m_{10}^2 m_{01}^2}{m_{00}^3}\label{eq: K 22 from moments}
\end{align}

\subsection{Central moments from cumulants}
\label{sub:Central moments from cumulants}
The approach stated in Chapter~\ref{sub:Cumulants from moments} would certainly work, but the transformations would get cumbersome to compute, especially in three dimensions. As we will see, the transformations will be easier coming from central moments.

Albeit, the deduction is a bit more complicated, as we can't break down the definition of the central moments to cumulants as easily as for raw moments.
Markus Muhr provides an easy remedy in writing
\begin{equation}
  F_c(\Xi_1, \Xi_2) = \exp(\ln(F(\Xi_1,\Xi_2)) - \Xi_1 u_1 - \Xi_2 u_2).
\end{equation}
In addition to the abbreviations in~\eqref{eq:abbreviations for deriving cumulants from moments}, we define the folowing
\begin{equation}
  \begin{aligned}
    E & \defined \exp(\ln(F(\Xi_1,\Xi_2)) - \Xi_1 u_1 - \Xi_2 u_2) \\
    L_i & \defined \partial_i \ln(F) - u_i
  \end{aligned}
\end{equation}
and therefore
\begin{equation}
  \begin{aligned}
    \partial_i E & = EL_i \\
    \partial_i L_j & = \partial_i\partial_j\ln(F)\\
    L_1\bigr|_{\Xi_1=\Xi_2 = 0} & = \bigg(
      \underbrace{{(-c)}^{-1} \partial_1\ln(F) \bigr|_{\Xi_1=\Xi_2 = 0}}_{=-\kappa_{10}=-\frac{m_{10}}{m_{00}}}
      - \underbrace{{(-c)}^{-1}u_1}_{=-\frac{m_{10}}{m_{00}}} \bigg) = 0 \\
    L_2\bigr|_{\Xi_1=\Xi_2 = 0} & = 0.
  \end{aligned}
\end{equation}

\subsubsection{Revisiting the central moment definition}
\label{subs:Revisiting the central moment definition}
Now, we can revisit the definition of the central moments,~\eqref{eq:alternative representation of central moments}, which now read
\begin{equation}
  \begin{aligned}
    c_{\alpha\beta}= {(-c)}^{-\alpha-\beta} \partial_1^\alpha \partial_2^\beta E\bigr|_{\Xi_1=\Xi_2 = 0}
  \end{aligned}
\end{equation}
%
From there on, we can express
\begin{align*}
  \phantom{c_{00}}
  &\begin{aligned}
  \nonumber
    \mathllap{c_{00}} & = E\bigr|_{\Xi_1=\Xi_2 = 0} = F(0,0) = m_{00}
  \end{aligned}\\
  %
  &\begin{aligned}
  \nonumber
    \mathllap{c_{10}} & = {(-c)}^{-1} \partial_1 E  \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = {(-c)}^{-1} EL_1  \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = 0
  \end{aligned}\\
  %
  &\begin{aligned}
  \nonumber
    \mathllap{c_{20}} & = {(-c)}^{-2} \partial_1 (EL_1)  \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = {(-c)}^{-2} \big( EL_1^2 + E \partial_1^2\ln(F)\big)  \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = {(-c)}^{-2} \big( 0 + \underbrace{E \bigr|_{\Xi_1=\Xi_2 = 0}}_{=m_{00}}
    \underbrace{\partial_1^2\ln(F) \bigr|_{\Xi_1=\Xi_2 = 0}}_{={(-c)}^{2}\kappa_{20}} \big) \\
    & = m_{00}\kappa_{20}
  \end{aligned}\\
  %
  &\begin{aligned}
  \nonumber
    \mathllap{c_{11}} & = {(-c)}^{-2} \partial_2 (EL_1) \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = {(-c)}^{-2} \big( E L_1 L_2 + E \partial_1\partial_2\ln(F) \big)  \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = m_{00}\kappa_{11}
  \end{aligned}\\
  %
  &\begin{aligned}
  \nonumber
    \mathllap{c_{21}} & = {(-c)}^{-3} \partial_2 \big(EL_1^2 + E \partial_1^2\ln(F)\big)  \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = {(-c)}^{-3} \big( E L_1^2 L_2 + 2EL_1\partial_1\partial_2\ln(F) \\
      &\qquad\quad\ \ + EL_2 \partial_1^2\ln(F) + E \partial_1^2\partial_2\ln(F) \big)  \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = m_{00}\kappa_{21}
  \end{aligned}\\
  %
  &\begin{aligned}
  \nonumber
    \mathllap{c_{22}} & = {(-c)}^{-4} \partial_2 \big( E L_1^2 L_2 + 2EL_1\partial_1\partial_2\ln(F) \\
      &\qquad\qquad\ \ + EL_2 \partial_1^2\ln(F) + E \partial_1^2\partial_2\ln(F) \big)  \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = {(-c)}^{-4} \big(
      E L_1^2 L_2^2 + E L_2^2 \partial_2^2\ln(F) + 2 E L_1 L_2 \partial_1\partial_2 \ln(F) \\
    & \qquad\quad\ \ +
      2 E L_1 L_2 \partial_1\partial_2 \ln(F) + 2 E \partial_1\partial_2 \ln(F) \partial_1\partial_2 \ln(F) + 2 E L_1 \partial_1\partial_2^2 \ln(F) \\
    & \qquad\quad\ \ +
      E L_2^2 \partial_1^2 \ln(F) + E \partial_1^2 \ln(F) \partial_2^2 \ln(F) + E L_2 \partial_1\partial_2^2 \ln(F) \\
    & \qquad\quad\ \ +
      E L_2 \partial_1^2 \partial_2 \ln(F) + E\partial_1^2\partial_2^2 \ln(F)
      \big) \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = {(-c)}^{-4} \big(
    0 + 0 + 0 \\
    & \qquad\quad\ \ +
      0 + 2 E \partial_1\partial_2 \ln(F) \partial_1\partial_2 \ln(F) + 0 \\
    & \qquad\quad\ \ +
      0 + E \partial_1^2 \ln(F) \partial_2^2 \ln(F) + 0 \\
    & \qquad\quad\ \ +
      0 + E\partial_1^2\partial_2^2 \ln(F)
      \big) \bigr|_{\Xi_1=\Xi_2 = 0} \\
    & = m_{00}(\kappa_{22} + 2\kappa_{11}^2 + \kappa_{20}\kappa_{02})
  \end{aligned}
\end{align*}
The missing central moments follow from permutation and will be listed in the following

\subsubsection{Listing the central moments from cumulants}
\label{subs:Listing the central moments from cumulants}
\begin{equation}
  \label{eq:all central moments from cumulants}
  \begin{aligned}
    c_{00} & = m_{00} \\
    c_{10} & = 0 \\
    c_{01} & = 0 \\
    c_{20} & = m_{00}\kappa_{20} \\
    c_{02} & = m_{00}\kappa_{02} \\
    c_{11} & = m_{00}\kappa_{11} \\
    c_{21} & = m_{00}\kappa_{21} \\
    c_{12} & = m_{00}\kappa_{12} \\
    c_{22} & = m_{00}(\kappa_{22} + 2\kappa_{11}^2 + \kappa_{20}\kappa_{02})
  \end{aligned}
\end{equation}
As we can se here, cumulants for non conserved modes only differ from central moments, apart from scaling, in order higher than $3$.

\subsubsection{Central moments from scaled Cumulants}
\label{subs:Central moments from scaled Cumulants}

As shown in the previous section, the cumulants only appear together with the density. Hence, we express the cumulants again in the normalized version~\eqref{eq: definition normalized cumulants} which yields
\begin{equation}
  \label{eq:all central moments from normalized cumulants}
  \begin{aligned}
    c_{00} & = m_{00}\\
    c_{10} & = 0 \\
    c_{01} & = 0 \\
    c_{20} & = K_{20} \\
    c_{02} & = K_{02} \\
    c_{11} & = K_{11} \\
    c_{21} & = K_{21} \\
    c_{12} & = K_{12} \\
    c_{22} & = K_{22} + 2 \frac{K_{11}^2}{m_{00}} + \frac{K_{20}K_{02}}{m_{00}}
  \end{aligned}
\end{equation}
which is much more convenient to handle.

\subsection{Cumulants from central moments}
\label{sub:Cumulants from central moments}
For implementing the cumulant LBM, we also need to get cumulants from central moments, as we want to have the collision in the cumulant space. Coming from~\ref{subs:Listing the central moments from cumulants} this is an easy task. We have to distinguish between the different equations in~\eqref{eq:all central moments from cumulants}.
The first three can not be inverted but have to be computed from the moments $m_{00}$, $m_{10}$ and $m_{01}$ which we need anyway for the central moments. All other but the last equation are inverted straightforward.
Inserting the resulting equations for $\kappa_{11}$, $\kappa_{02}$ and $\kappa_{20}$ in the last equation, we get
\begin{equation}
  \label{eq:all cumulants from central moments}
  \begin{aligned}
    \kappa_{00} & = \ln(m_{00})\\
    \kappa_{10} & = \frac{m_{10}}{m_{00}} \\
    \kappa_{01} & = \frac{m_{01}}{m_{00}} \\
    \kappa_{20} & = \frac{c_{20}}{m_{00}} \\
    \kappa_{02} & = \frac{c_{02}}{m_{00}} \\
    \kappa_{11} & = \frac{c_{11}}{m_{00}} \\
    \kappa_{21} & = \frac{c_{21}}{m_{00}} \\
    \kappa_{12} & = \frac{c_{12}}{m_{00}} \\
    \kappa_{22} & = \frac{c_{22}}{m_{00}} - 2{\left(\frac{c_{11}}{m_{00}}\right)}^2 - \frac{c_{20}}{m_{00}}\frac{c_{02}}{m_{00}}
  \end{aligned}
\end{equation}
%
or with the normalized cumulants
\begin{equation}
  \begin{aligned}
    \label{eq:all normalized cumulants from central moments}
    K_{00} & = \ln(m_{00})m_{00} \\
    K_{10} & = m_{10} \\
    K_{01} & = m_{01} \\
    K_{20} & = c_{20} \\
    K_{02} & = c_{02} \\
    K_{11} & = c_{11} \\
    K_{21} & = c_{21} \\
    K_{12} & = c_{12} \\
    K_{22} & = c_{22} - 2 \frac{{c_{11}}^2}{m_{00}} - \frac{c_{20}c_{02}}{m_{00}}
  \end{aligned}
\end{equation}

\subsection{Fast central moment transformations}
\label{sub:Fast central moment transformations}

As cumulants of low orders are easily derived from central moments, we seek a fast way to compute the latter and afterwards get the distribution functions back for streaming.

\subsubsection{Forward transformation}
\label{subs:Forward transformation}

The forward central moment transformation splits the definition for a two way calculation
\begin{equation}
  \begin{aligned}
    c_{\alpha\beta}
    & = \sum_{ij} {\left(i-\frac{u_1}{c}\right)}^\alpha {\left(j-\frac{u_2}{c}\right)}^\beta f_{ij} \\
    & = \sum_{i} {\left(i-\frac{u_1}{c}\right)}^\alpha \underbrace{\sum_{j} {\left(j-\frac{u_2}{c}\right)}^\beta f_{ij}}_{\defines c_{i|\beta}} \\
    & = \sum_{i} {\left(i-\frac{u_1}{c}\right)}^\alpha c_{i|\beta}
  \end{aligned}
\end{equation}
Thus, by first computing the $c_{i|\beta}$ and then the $c_{\alpha\beta}$ we need $6$ instead of $9$ summations.
\todo[inline]{more saving when calculating all central moments}
By chaining this technique in 3D, much more computing power is saved.
We can further analyze the $c_{\alpha\beta}$ and $c_{i|\beta}$ terms:
\begin{equation}
  \begin{aligned}
    \label{eq:fast forward c alpha beta expanded}
    c_{\alpha\beta} & = \sum_{i} {\left(i-\frac{u_1}{c}\right)}^\alpha c_{i|\beta} \\
    & = {\left(-1-\frac{u_1}{c}\right)}^\alpha c_{-1|\beta} + {\left(-\frac{u_1}{c}\right)}^\alpha c_{0|\beta} + {\left(1-\frac{u_1}{c}\right)}^\alpha c_{1|\beta}
  \end{aligned}
\end{equation}

\begin{equation}
  \begin{aligned}
    \label{eq:fast forward c i pipe beta expanded}
    c_{i|\beta} & = \sum_{j} {\left(j-\frac{u_2}{c}\right)}^\beta f_{ij} \\
    & = {\left(-1-\frac{u_2}{c}\right)}^\beta f_{i-1} + {\left(-\frac{u_2}{c}\right)}^\beta f_{i0} + {\left(1-\frac{u_2}{c}\right)}^\beta f_{i1}
  \end{aligned}
\end{equation}
With~\eqref{eq:fast forward c alpha beta expanded}, we can explicitly write
\begin{equation}
  \label{eq:fast forward c alpha beta matrix}
  \begin{pmatrix}
    c_{0\beta} \\
    c_{1\beta} \\
    c_{2\beta}
  \end{pmatrix}
  =
  \begin{pmatrix}
    1 & 1 & 1 \\
    -1-\frac{u_1}{c} & - \frac{u_1}{c} &   1-\frac{u_1}{c} \\
    {\left(-1-\frac{u_1}{c}\right)}^2 & {\left(\frac{u_1}{c}\right)}^2 &  {\left(1-\frac{u_1}{c}\right)}^2
  \end{pmatrix}
  \begin{pmatrix}
    c_{-1|\beta} \\
    c_{0|\beta} \\
    c_{1|\beta}
  \end{pmatrix}
\end{equation}
and with~\eqref{eq:fast forward c i pipe beta expanded}
\begin{equation}
  \label{eq:fast forward c i pipe beta matrix}
  \begin{pmatrix}
    c_{i|0} \\
    c_{i|1} \\
    c_{i|2}
  \end{pmatrix}
  =
  \begin{pmatrix}
    1 & 1 & 1 \\
    -1-\frac{u_2}{c} & - \frac{u_2}{c} &   1-\frac{u_2}{c} \\
    {\left(-1-\frac{u_2}{c}\right)}^2 & {\left(\frac{u_2}{c}\right)}^2 &  {\left(1-\frac{u_2}{c}\right)}^2
  \end{pmatrix}
  \begin{pmatrix}
    f_{i-1} \\
    f_{i0} \\
    f_{i1}
  \end{pmatrix}
\end{equation}

\subsubsection{Backward transformation}
\label{subs:Backward transformation}
To get the backwards direction, the systems~\eqref{eq:fast forward c alpha beta expanded}
and~\eqref{eq:fast forward c i pipe beta expanded} are now solved where~\eqref{eq:fast forward c alpha beta matrix} becomes, (cf.\ mathematica/backward\_transformation.nb)
\begin{equation}
  \begin{pmatrix}
    c_{-1|\beta} \\
    c_{0|\beta} \\
    c_{1|\beta}
  \end{pmatrix}
  =
  \begin{pmatrix}[1.5]
    -\frac{1}{2}(\frac{u_1}{c} - {(\frac{u_1}{c})}^2) &
    -\frac{1}{2}(1 - 2\frac{u_1}{c}) &
    \frac{1}{2} \\
    1 - {(\frac{u_1}{c})}^2  &
    -2\frac{u_1}{c}  &
    -1 \\
    \frac{1}{2}(\frac{u_1}{c} + {(\frac{u_1}{c})}^2)  &
    \frac{1}{2}(1 + 2\frac{u_1}{c})  &
    \frac{1}{2}
  \end{pmatrix}
  \begin{pmatrix}
    c_{0\beta} \\
    c_{1\beta} \\
    c_{2\beta}
  \end{pmatrix}
\end{equation}
and~\eqref{eq:fast forward c i pipe beta matrix} analogously
\begin{equation}
  \begin{pmatrix}
    f_{i-1} \\
    f_{i0} \\
    f_{i1}
  \end{pmatrix}
  =
  \begin{pmatrix}[1.5]
    -\frac{1}{2}(\frac{u_2}{c} - {(\frac{u_2}{c})}^2) &
    -\frac{1}{2}(1 - 2\frac{u_2}{c}) &
    \frac{1}{2} \\
    1 - {(\frac{u_2}{c})}^2  &
    -2\frac{u_2}{c}  &
    -1 \\
    \frac{1}{2}(\frac{u_2}{c} + {(\frac{u_2}{c})}^2)  &
    \frac{1}{2}(1 + 2\frac{u_2}{c})  &
    \frac{1}{2}
  \end{pmatrix}
  \begin{pmatrix}
      c_{i|0} \\
      c_{i|1} \\
      c_{i|2}
    \end{pmatrix}
\end{equation}
