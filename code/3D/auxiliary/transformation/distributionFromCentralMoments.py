from numpy import *

def distributionFromCentralMoments(u, k_000, k_001, k_002, k_010, k_011, k_012, k_020, k_021, k_022,
                                     k_100, k_101, k_102, k_110, k_111, k_112, k_120, k_121, k_122,
                                     k_200, k_201, k_202, k_210, k_211, k_212, k_220, k_221, k_222):
    ux = u[0]
    uy = u[1]
    uz = u[2]

    (nx,ny,nz) = ux.shape
    f = zeros((3,3,3,nx,ny,nz))

    k_1_00 =  k_000*(1 - ux**2)  - k_100*2*ux       - k_200
    k_0_00 = (k_000*(ux**2 - ux) + k_100*(2*ux - 1) + k_200) * 0.5
    k_2_00 = (k_000*(ux**2 + ux) + k_100*(2*ux + 1) + k_200) * 0.5
    k_1_01 =  k_001*(1 - ux**2)  - k_101*2*ux       - k_201
    k_0_01 = (k_001*(ux**2 - ux) + k_101*(2*ux - 1) + k_201) * 0.5
    k_2_01 = (k_001*(ux**2 + ux) + k_101*(2*ux + 1) + k_201) * 0.5
    k_1_02 =  k_002*(1 - ux**2)  - k_102*2*ux       - k_202
    k_0_02 = (k_002*(ux**2 - ux) + k_102*(2*ux - 1) + k_202) * 0.5
    k_2_02 = (k_002*(ux**2 + ux) + k_102*(2*ux + 1) + k_202) * 0.5
    k_1_10 =  k_010*(1 - ux**2)  - k_110*2*ux       - k_210
    k_0_10 = (k_010*(ux**2 - ux) + k_110*(2*ux - 1) + k_210) * 0.5
    k_2_10 = (k_010*(ux**2 + ux) + k_110*(2*ux + 1) + k_210) * 0.5
    k_1_11 =  k_011*(1 - ux**2)  - k_111*2*ux       - k_211
    k_0_11 = (k_011*(ux**2 - ux) + k_111*(2*ux - 1) + k_211) * 0.5
    k_2_11 = (k_011*(ux**2 + ux) + k_111*(2*ux + 1) + k_211) * 0.5
    k_1_12 =  k_012*(1 - ux**2)  - k_112*2*ux       - k_212
    k_0_12 = (k_012*(ux**2 - ux) + k_112*(2*ux - 1) + k_212) * 0.5
    k_2_12 = (k_012*(ux**2 + ux) + k_112*(2*ux + 1) + k_212) * 0.5
    k_1_20 =  k_020*(1 - ux**2)  - k_120*2*ux       - k_220
    k_0_20 = (k_020*(ux**2 - ux) + k_120*(2*ux - 1) + k_220) * 0.5
    k_2_20 = (k_020*(ux**2 + ux) + k_120*(2*ux + 1) + k_220) * 0.5
    k_1_21 =  k_021*(1 - ux**2)  - k_121*2*ux       - k_221
    k_0_21 = (k_021*(ux**2 - ux) + k_121*(2*ux - 1) + k_221) * 0.5
    k_2_21 = (k_021*(ux**2 + ux) + k_121*(2*ux + 1) + k_221) * 0.5
    k_1_22 =  k_022*(1 - ux**2)  - k_122*2*ux       - k_222
    k_0_22 = (k_022*(ux**2 - ux) + k_122*(2*ux - 1) + k_222) * 0.5
    k_2_22 = (k_022*(ux**2 + ux) + k_122*(2*ux + 1) + k_222) * 0.5
    k_01_0 =  k_0_00*(1 - uy**2)  - k_0_10*2*uy       - k_0_20
    k_00_0 = (k_0_00*(uy**2 - uy) + k_0_10*(2*uy - 1) + k_0_20) * 0.5
    k_02_0 = (k_0_00*(uy**2 + uy) + k_0_10*(2*uy + 1) + k_0_20) * 0.5
    k_01_1 =  k_0_01*(1 - uy**2)  - k_0_11*2*uy       - k_0_21
    k_00_1 = (k_0_01*(uy**2 - uy) + k_0_11*(2*uy - 1) + k_0_21) * 0.5
    k_02_1 = (k_0_01*(uy**2 + uy) + k_0_11*(2*uy + 1) + k_0_21) * 0.5
    k_01_2 =  k_0_02*(1 - uy**2)  - k_0_12*2*uy       - k_0_22
    k_00_2 = (k_0_02*(uy**2 - uy) + k_0_12*(2*uy - 1) + k_0_22) * 0.5
    k_02_2 = (k_0_02*(uy**2 + uy) + k_0_12*(2*uy + 1) + k_0_22) * 0.5
    k_11_0 =  k_1_00*(1 - uy**2)  - k_1_10*2*uy       - k_1_20
    k_10_0 = (k_1_00*(uy**2 - uy) + k_1_10*(2*uy - 1) + k_1_20) * 0.5
    k_12_0 = (k_1_00*(uy**2 + uy) + k_1_10*(2*uy + 1) + k_1_20) * 0.5
    k_11_1 =  k_1_01*(1 - uy**2)  - k_1_11*2*uy       - k_1_21
    k_10_1 = (k_1_01*(uy**2 - uy) + k_1_11*(2*uy - 1) + k_1_21) * 0.5
    k_12_1 = (k_1_01*(uy**2 + uy) + k_1_11*(2*uy + 1) + k_1_21) * 0.5
    k_11_2 =  k_1_02*(1 - uy**2)  - k_1_12*2*uy       - k_1_22
    k_10_2 = (k_1_02*(uy**2 - uy) + k_1_12*(2*uy - 1) + k_1_22) * 0.5
    k_12_2 = (k_1_02*(uy**2 + uy) + k_1_12*(2*uy + 1) + k_1_22) * 0.5
    k_21_0 =  k_2_00*(1 - uy**2)  - k_2_10*2*uy       - k_2_20
    k_20_0 = (k_2_00*(uy**2 - uy) + k_2_10*(2*uy - 1) + k_2_20) * 0.5
    k_22_0 = (k_2_00*(uy**2 + uy) + k_2_10*(2*uy + 1) + k_2_20) * 0.5
    k_21_1 =  k_2_01*(1 - uy**2)  - k_2_11*2*uy       - k_2_21
    k_20_1 = (k_2_01*(uy**2 - uy) + k_2_11*(2*uy - 1) + k_2_21) * 0.5
    k_22_1 = (k_2_01*(uy**2 + uy) + k_2_11*(2*uy + 1) + k_2_21) * 0.5
    k_21_2 =  k_2_02*(1 - uy**2)  - k_2_12*2*uy       - k_2_22
    k_20_2 = (k_2_02*(uy**2 - uy) + k_2_12*(2*uy - 1) + k_2_22) * 0.5
    k_22_2 = (k_2_02*(uy**2 + uy) + k_2_12*(2*uy + 1) + k_2_22) * 0.5
    f[0, 0, 1] =  k_00_0*(1 - uy**2)  - k_00_1*2*uy       - k_00_2
    f[0, 0, 0] = (k_00_0*(uy**2 - uy) + k_00_1*(2*uy - 1) + k_00_2) * 0.5
    f[0, 0, 2] = (k_00_0*(uy**2 + uy) + k_00_1*(2*uy + 1) + k_00_2) * 0.5
    f[0, 1, 1] =  k_01_0*(1 - uy**2)  - k_01_1*2*uy       - k_01_2
    f[0, 1, 0] = (k_01_0*(uy**2 - uy) + k_01_1*(2*uy - 1) + k_01_2) * 0.5
    f[0, 1, 2] = (k_01_0*(uy**2 + uy) + k_01_1*(2*uy + 1) + k_01_2) * 0.5
    f[0, 2, 1] =  k_02_0*(1 - uy**2)  - k_02_1*2*uy       - k_02_2
    f[0, 2, 0] = (k_02_0*(uy**2 - uy) + k_02_1*(2*uy - 1) + k_02_2) * 0.5
    f[0, 2, 2] = (k_02_0*(uy**2 + uy) + k_02_1*(2*uy + 1) + k_02_2) * 0.5
    f[1, 0, 1] =  k_10_0*(1 - uy**2)  - k_10_1*2*uy       - k_10_2
    f[1, 0, 0] = (k_10_0*(uy**2 - uy) + k_10_1*(2*uy - 1) + k_10_2) * 0.5
    f[1, 0, 2] = (k_10_0*(uy**2 + uy) + k_10_1*(2*uy + 1) + k_10_2) * 0.5
    f[1, 1, 1] =  k_11_0*(1 - uy**2)  - k_11_1*2*uy       - k_11_2
    f[1, 1, 0] = (k_11_0*(uy**2 - uy) + k_11_1*(2*uy - 1) + k_11_2) * 0.5
    f[1, 1, 2] = (k_11_0*(uy**2 + uy) + k_11_1*(2*uy + 1) + k_11_2) * 0.5
    f[1, 2, 1] =  k_12_0*(1 - uy**2)  - k_12_1*2*uy       - k_12_2
    f[1, 2, 0] = (k_12_0*(uy**2 - uy) + k_12_1*(2*uy - 1) + k_12_2) * 0.5
    f[1, 2, 2] = (k_12_0*(uy**2 + uy) + k_12_1*(2*uy + 1) + k_12_2) * 0.5
    f[2, 0, 1] =  k_20_0*(1 - uy**2)  - k_20_1*2*uy       - k_20_2
    f[2, 0, 0] = (k_20_0*(uy**2 - uy) + k_20_1*(2*uy - 1) + k_20_2) * 0.5
    f[2, 0, 2] = (k_20_0*(uy**2 + uy) + k_20_1*(2*uy + 1) + k_20_2) * 0.5
    f[2, 1, 1] =  k_21_0*(1 - uy**2)  - k_21_1*2*uy       - k_21_2
    f[2, 1, 0] = (k_21_0*(uy**2 - uy) + k_21_1*(2*uy - 1) + k_21_2) * 0.5
    f[2, 1, 2] = (k_21_0*(uy**2 + uy) + k_21_1*(2*uy + 1) + k_21_2) * 0.5
    f[2, 2, 1] =  k_22_0*(1 - uy**2)  - k_22_1*2*uy       - k_22_2
    f[2, 2, 0] = (k_22_0*(uy**2 - uy) + k_22_1*(2*uy - 1) + k_22_2) * 0.5
    f[2, 2, 2] = (k_22_0*(uy**2 + uy) + k_22_1*(2*uy + 1) + k_22_2) * 0.5

    return f
