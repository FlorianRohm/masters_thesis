# 3D Lattice Boltzmann Code
# Copyright (C) 2016  Florian Rohm
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

from numpy import *

def centralMomentFromDistribution(u, f):
    ux = u[0]
    uy = u[1]
    uz = u[2]

    k_00_0 = f[0,0,0]              + f[0,0,1]           + f[0,0,2]
    k_00_1 = f[0,0,0]*(-1 - uz)    + f[0,0,1]*(- uz)    + f[0,0,2]*(1 - uz)
    k_00_2 = f[0,0,0]*(-1 - uz)**2 + f[0,0,1]*(- uz)**2 + f[0,0,2]*(1 - uz)**2
    k_01_0 = f[0,1,0]              + f[0,1,1]           + f[0,1,2]
    k_01_1 = f[0,1,0]*(-1 - uz)    + f[0,1,1]*(- uz)    + f[0,1,2]*(1 - uz)
    k_01_2 = f[0,1,0]*(-1 - uz)**2 + f[0,1,1]*(- uz)**2 + f[0,1,2]*(1 - uz)**2
    k_02_0 = f[0,2,0]              + f[0,2,1]           + f[0,2,2]
    k_02_1 = f[0,2,0]*(-1 - uz)    + f[0,2,1]*(- uz)    + f[0,2,2]*(1 - uz)
    k_02_2 = f[0,2,0]*(-1 - uz)**2 + f[0,2,1]*(- uz)**2 + f[0,2,2]*(1 - uz)**2
    k_10_0 = f[1,0,0]              + f[1,0,1]           + f[1,0,2]
    k_10_1 = f[1,0,0]*(-1 - uz)    + f[1,0,1]*(- uz)    + f[1,0,2]*(1 - uz)
    k_10_2 = f[1,0,0]*(-1 - uz)**2 + f[1,0,1]*(- uz)**2 + f[1,0,2]*(1 - uz)**2
    k_11_0 = f[1,1,0]              + f[1,1,1]           + f[1,1,2]
    k_11_1 = f[1,1,0]*(-1 - uz)    + f[1,1,1]*(- uz)    + f[1,1,2]*(1 - uz)
    k_11_2 = f[1,1,0]*(-1 - uz)**2 + f[1,1,1]*(- uz)**2 + f[1,1,2]*(1 - uz)**2
    k_12_0 = f[1,2,0]              + f[1,2,1]           + f[1,2,2]
    k_12_1 = f[1,2,0]*(-1 - uz)    + f[1,2,1]*(- uz)    + f[1,2,2]*(1 - uz)
    k_12_2 = f[1,2,0]*(-1 - uz)**2 + f[1,2,1]*(- uz)**2 + f[1,2,2]*(1 - uz)**2
    k_20_0 = f[2,0,0]              + f[2,0,1]           + f[2,0,2]
    k_20_1 = f[2,0,0]*(-1 - uz)    + f[2,0,1]*(- uz)    + f[2,0,2]*(1 - uz)
    k_20_2 = f[2,0,0]*(-1 - uz)**2 + f[2,0,1]*(- uz)**2 + f[2,0,2]*(1 - uz)**2
    k_21_0 = f[2,1,0]              + f[2,1,1]           + f[2,1,2]
    k_21_1 = f[2,1,0]*(-1 - uz)    + f[2,1,1]*(- uz)    + f[2,1,2]*(1 - uz)
    k_21_2 = f[2,1,0]*(-1 - uz)**2 + f[2,1,1]*(- uz)**2 + f[2,1,2]*(1 - uz)**2
    k_22_0 = f[2,2,0]              + f[2,2,1]           + f[2,2,2]
    k_22_1 = f[2,2,0]*(-1 - uz)    + f[2,2,1]*(- uz)    + f[2,2,2]*(1 - uz)
    k_22_2 = f[2,2,0]*(-1 - uz)**2 + f[2,2,1]*(- uz)**2 + f[2,2,2]*(1 - uz)**2
    k_0_00 = k_00_0              + k_01_0           + k_02_0
    k_0_10 = k_00_0*(-1 - uy)    + k_01_0*(- uy)    + k_02_0*(1 - uy)
    k_0_20 = k_00_0*(-1 - uy)**2 + k_01_0*(- uy)**2 + k_02_0*(1 - uy)**2
    k_0_01 = k_00_1              + k_01_1           + k_02_1
    k_0_11 = k_00_1*(-1 - uy)    + k_01_1*(- uy)    + k_02_1*(1 - uy)
    k_0_21 = k_00_1*(-1 - uy)**2 + k_01_1*(- uy)**2 + k_02_1*(1 - uy)**2
    k_0_02 = k_00_2              + k_01_2           + k_02_2
    k_0_12 = k_00_2*(-1 - uy)    + k_01_2*(- uy)    + k_02_2*(1 - uy)
    k_0_22 = k_00_2*(-1 - uy)**2 + k_01_2*(- uy)**2 + k_02_2*(1 - uy)**2
    k_1_00 = k_10_0              + k_11_0           + k_12_0
    k_1_10 = k_10_0*(-1 - uy)    + k_11_0*(- uy)    + k_12_0*(1 - uy)
    k_1_20 = k_10_0*(-1 - uy)**2 + k_11_0*(- uy)**2 + k_12_0*(1 - uy)**2
    k_1_01 = k_10_1              + k_11_1           + k_12_1
    k_1_11 = k_10_1*(-1 - uy)    + k_11_1*(- uy)    + k_12_1*(1 - uy)
    k_1_21 = k_10_1*(-1 - uy)**2 + k_11_1*(- uy)**2 + k_12_1*(1 - uy)**2
    k_1_02 = k_10_2              + k_11_2           + k_12_2
    k_1_12 = k_10_2*(-1 - uy)    + k_11_2*(- uy)    + k_12_2*(1 - uy)
    k_1_22 = k_10_2*(-1 - uy)**2 + k_11_2*(- uy)**2 + k_12_2*(1 - uy)**2
    k_2_00 = k_20_0              + k_21_0           + k_22_0
    k_2_10 = k_20_0*(-1 - uy)    + k_21_0*(- uy)    + k_22_0*(1 - uy)
    k_2_20 = k_20_0*(-1 - uy)**2 + k_21_0*(- uy)**2 + k_22_0*(1 - uy)**2
    k_2_01 = k_20_1              + k_21_1           + k_22_1
    k_2_11 = k_20_1*(-1 - uy)    + k_21_1*(- uy)    + k_22_1*(1 - uy)
    k_2_21 = k_20_1*(-1 - uy)**2 + k_21_1*(- uy)**2 + k_22_1*(1 - uy)**2
    k_2_02 = k_20_2              + k_21_2           + k_22_2
    k_2_12 = k_20_2*(-1 - uy)    + k_21_2*(- uy)    + k_22_2*(1 - uy)
    k_2_22 = k_20_2*(-1 - uy)**2 + k_21_2*(- uy)**2 + k_22_2*(1 - uy)**2
    k_000 = k_0_00              + k_1_00           + k_2_00
    k_100 = k_0_00*(-1 - ux)    + k_1_00*(- ux)    + k_2_00*(1 - ux)
    k_200 = k_0_00*(-1 - ux)**2 + k_1_00*(- ux)**2 + k_2_00*(1 - ux)**2
    k_001 = k_0_01              + k_1_01           + k_2_01
    k_101 = k_0_01*(-1 - ux)    + k_1_01*(- ux)    + k_2_01*(1 - ux)
    k_201 = k_0_01*(-1 - ux)**2 + k_1_01*(- ux)**2 + k_2_01*(1 - ux)**2
    k_002 = k_0_02              + k_1_02           + k_2_02
    k_102 = k_0_02*(-1 - ux)    + k_1_02*(- ux)    + k_2_02*(1 - ux)
    k_202 = k_0_02*(-1 - ux)**2 + k_1_02*(- ux)**2 + k_2_02*(1 - ux)**2
    k_010 = k_0_10              + k_1_10           + k_2_10
    k_110 = k_0_10*(-1 - ux)    + k_1_10*(- ux)    + k_2_10*(1 - ux)
    k_210 = k_0_10*(-1 - ux)**2 + k_1_10*(- ux)**2 + k_2_10*(1 - ux)**2
    k_011 = k_0_11              + k_1_11           + k_2_11
    k_111 = k_0_11*(-1 - ux)    + k_1_11*(- ux)    + k_2_11*(1 - ux)
    k_211 = k_0_11*(-1 - ux)**2 + k_1_11*(- ux)**2 + k_2_11*(1 - ux)**2
    k_012 = k_0_12              + k_1_12           + k_2_12
    k_112 = k_0_12*(-1 - ux)    + k_1_12*(- ux)    + k_2_12*(1 - ux)
    k_212 = k_0_12*(-1 - ux)**2 + k_1_12*(- ux)**2 + k_2_12*(1 - ux)**2
    k_020 = k_0_20              + k_1_20           + k_2_20
    k_120 = k_0_20*(-1 - ux)    + k_1_20*(- ux)    + k_2_20*(1 - ux)
    k_220 = k_0_20*(-1 - ux)**2 + k_1_20*(- ux)**2 + k_2_20*(1 - ux)**2
    k_021 = k_0_21              + k_1_21           + k_2_21
    k_121 = k_0_21*(-1 - ux)    + k_1_21*(- ux)    + k_2_21*(1 - ux)
    k_221 = k_0_21*(-1 - ux)**2 + k_1_21*(- ux)**2 + k_2_21*(1 - ux)**2
    k_022 = k_0_22              + k_1_22           + k_2_22
    k_122 = k_0_22*(-1 - ux)    + k_1_22*(- ux)    + k_2_22*(1 - ux)
    k_222 = k_0_22*(-1 - ux)**2 + k_1_22*(- ux)**2 + k_2_22*(1 - ux)**2

    return ( k_000, k_001, k_002, k_010, k_011, k_012, k_020, k_021, k_022,
             k_100, k_101, k_102, k_110, k_111, k_112, k_120, k_121, k_122,
             k_200, k_201, k_202, k_210, k_211, k_212, k_220, k_221, k_222)
