from numpy import *

def centralMomentFromDistribution(u, f):
    ux = u[0]
    uy = u[1]
    uz = u[2]

    k1_n1n1_0 = f[0,0,0] + f[0,0,1] + f[0,0,2]
    k1_0n1_0  = f[1,0,0] + f[1,0,1] + f[1,0,2]
    k1_1n1_0  = f[2,0,0] + f[2,0,1] + f[2,0,2]

    k1_n10_0 = f[0,1,0] + f[0,1,1] + f[0,1,2]
    k1_00_0  = f[1,1,0] + f[1,1,1] + f[1,1,2]
    k1_10_0  = f[2,1,0] + f[2,1,1] + f[2,1,2]

    k1_n11_0 = f[0,2,0] + f[0,2,1] + f[0,2,2]
    k1_01_0  = f[1,2,0] + f[1,2,1] + f[1,2,2]
    k1_11_0  = f[2,2,0] + f[2,2,1] + f[2,2,2]


    k1_n1n1_1 = f[0,0,0]*(-1 - uz) - f[0,0,1]*(uz) + f[0,0,2]*(1 - uz)
    k1_0n1_1  = f[1,0,0]*(-1 - uz) - f[1,0,1]*(uz) + f[1,0,2]*(1 - uz)
    k1_1n1_1  = f[2,0,0]*(-1 - uz) - f[2,0,1]*(uz) + f[2,0,2]*(1 - uz)

    k1_n10_1 = f[0,1,0]*(-1 - uz) - f[0,1,1]*(uz) + f[0,1,2]*(1 - uz)
    k1_00_1  = f[1,1,0]*(-1 - uz) - f[1,1,1]*(uz) + f[1,1,2]*(1 - uz)
    k1_10_1  = f[2,1,0]*(-1 - uz) - f[2,1,1]*(uz) + f[2,1,2]*(1 - uz)

    k1_n11_1 = f[0,2,0]*(-1 - uz) - f[0,2,1]*(uz) + f[0,2,2]*(1 - uz)
    k1_01_1  = f[1,2,0]*(-1 - uz) - f[1,2,1]*(uz) + f[1,2,2]*(1 - uz)
    k1_11_1  = f[2,2,0]*(-1 - uz) - f[2,2,1]*(uz) + f[2,2,2]*(1 - uz)


    k1_n1n1_2 = f[0,0,0]*(-1 - uz)**2 + f[0,0,1]*uz**2 + f[0,0,2]*(1 - uz)**2
    k1_0n1_2  = f[1,0,0]*(-1 - uz)**2 + f[1,0,1]*uz**2 + f[1,0,2]*(1 - uz)**2
    k1_1n1_2  = f[2,0,0]*(-1 - uz)**2 + f[2,0,1]*uz**2 + f[2,0,2]*(1 - uz)**2

    k1_n10_2 = f[0,1,0]*(-1 - uz)**2 + f[0,1,1]*uz**2 + f[0,1,2]*(1 - uz)**2
    k1_00_2  = f[1,1,0]*(-1 - uz)**2 + f[1,1,1]*uz**2 + f[1,1,2]*(1 - uz)**2
    k1_10_2  = f[2,1,0]*(-1 - uz)**2 + f[2,1,1]*uz**2 + f[2,1,2]*(1 - uz)**2

    k1_n11_2 = f[0,2,0]*(-1 - uz)**2 + f[0,2,1]*uz**2 + f[0,2,2]*(1 - uz)**2
    k1_01_2  = f[1,2,0]*(-1 - uz)**2 + f[1,2,1]*uz**2 + f[1,2,2]*(1 - uz)**2
    k1_11_2  = f[2,2,0]*(-1 - uz)**2 + f[2,2,1]*uz**2 + f[2,2,2]*(1 - uz)**2

    #######

    k2_n1_00 = k1_n1n1_0 + k1_n10_0 + k1_n11_0
    k2_0_00  = k1_0n1_0  + k1_00_0  + k1_01_0
    k2_1_00  = k1_1n1_0  + k1_10_0  + k1_11_0

    k2_n1_01 = k1_n1n1_1 + k1_n10_1 + k1_n11_1
    k2_0_01  = k1_0n1_1  + k1_00_1  + k1_01_1
    k2_1_01  = k1_1n1_1  + k1_10_1  + k1_11_1

    k2_n1_02 = k1_n1n1_2 + k1_n10_2 + k1_n11_2
    k2_0_02  = k1_0n1_2  + k1_00_2  + k1_01_2
    k2_1_02  = k1_1n1_2  + k1_10_2  + k1_11_2


    k2_n1_10 = k1_n1n1_0*(-1-uy) - k1_n10_0*uy + k1_n11_0*(1-uy)
    k2_0_10  = k1_0n1_0*(-1-uy)  - k1_00_0*uy  + k1_01_0*(1-uy)
    k2_1_10  = k1_1n1_0*(-1-uy)  - k1_10_0*uy  + k1_11_0*(1-uy)

    k2_n1_11 = k1_n1n1_1*(-1-uy) - k1_n10_1*uy + k1_n11_1*(1-uy)
    k2_0_11  = k1_0n1_1*(-1-uy)  - k1_00_1*uy  + k1_01_1*(1-uy)
    k2_1_11  = k1_1n1_1*(-1-uy)  - k1_10_1*uy  + k1_11_1*(1-uy)

    k2_n1_12 = k1_n1n1_2*(-1-uy) - k1_n10_2*uy + k1_n11_2*(1-uy)
    k2_0_12  = k1_0n1_2*(-1-uy)  - k1_00_2*uy  + k1_01_2*(1-uy)
    k2_1_12  = k1_1n1_2*(-1-uy)  - k1_10_2*uy  + k1_11_2*(1-uy)


    k2_n1_20 = k1_n1n1_0*(-1-uy)**2 + k1_n10_0*uy**2 + k1_n11_0*(1-uy)**2
    k2_0_20  = k1_0n1_0*(-1-uy)**2  + k1_00_0*uy**2  + k1_01_0*(1-uy)**2
    k2_1_20  = k1_1n1_0*(-1-uy)**2  + k1_10_0*uy**2  + k1_11_0*(1-uy)**2

    k2_n1_21 = k1_n1n1_1*(-1-uy)**2 + k1_n10_1*uy**2 + k1_n11_1*(1-uy)**2
    k2_0_21  = k1_0n1_1*(-1-uy)**2  + k1_00_1*uy**2  + k1_01_1*(1-uy)**2
    k2_1_21  = k1_1n1_1*(-1-uy)**2  + k1_10_1*uy**2  + k1_11_1*(1-uy)**2

    k2_n1_22 = k1_n1n1_2*(-1-uy)**2 + k1_n10_2*uy**2 + k1_n11_2*(1-uy)**2
    k2_0_22  = k1_0n1_2*(-1-uy)**2  + k1_00_2*uy**2  + k1_01_2*(1-uy)**2
    k2_1_22  = k1_1n1_2*(-1-uy)**2  + k1_10_2*uy**2  + k1_11_2*(1-uy)**2

    ########

    k_000 = k2_n1_00 + k2_0_00 + k2_1_00
    k_010 = k2_n1_10 + k2_0_10 + k2_1_10
    k_020 = k2_n1_20 + k2_0_20 + k2_1_20

    k_001 = k2_n1_01 + k2_0_01 + k2_1_01
    k_011 = k2_n1_11 + k2_0_11 + k2_1_11
    k_021 = k2_n1_21 + k2_0_21 + k2_1_21

    k_002 = k2_n1_02 + k2_0_02 + k2_1_02
    k_012 = k2_n1_12 + k2_0_12 + k2_1_12
    k_022 = k2_n1_22 + k2_0_22 + k2_1_22


    k_100 = k2_n1_00*(-1-ux) - k2_0_00*ux + k2_1_00*(1-ux)
    k_110 = k2_n1_10*(-1-ux) - k2_0_10*ux + k2_1_10*(1-ux)
    k_120 = k2_n1_20*(-1-ux) - k2_0_20*ux + k2_1_20*(1-ux)

    k_101 = k2_n1_01*(-1-ux) - k2_0_01*ux + k2_1_01*(1-ux)
    k_111 = k2_n1_11*(-1-ux) - k2_0_11*ux + k2_1_11*(1-ux)
    k_121 = k2_n1_21*(-1-ux) - k2_0_21*ux + k2_1_21*(1-ux)

    k_102 = k2_n1_02*(-1-ux) - k2_0_02*ux + k2_1_02*(1-ux)
    k_112 = k2_n1_12*(-1-ux) - k2_0_12*ux + k2_1_12*(1-ux)
    k_122 = k2_n1_22*(-1-ux) - k2_0_22*ux + k2_1_22*(1-ux)


    k_200 = k2_n1_00*(-1-ux)**2 + k2_0_00*ux**2 + k2_1_00*(1-ux)**2
    k_210 = k2_n1_10*(-1-ux)**2 + k2_0_10*ux**2 + k2_1_10*(1-ux)**2
    k_220 = k2_n1_20*(-1-ux)**2 + k2_0_20*ux**2 + k2_1_20*(1-ux)**2

    k_201 = k2_n1_01*(-1-ux)**2 + k2_0_01*ux**2 + k2_1_01*(1-ux)**2
    k_211 = k2_n1_11*(-1-ux)**2 + k2_0_11*ux**2 + k2_1_11*(1-ux)**2
    k_221 = k2_n1_21*(-1-ux)**2 + k2_0_21*ux**2 + k2_1_21*(1-ux)**2

    k_202 = k2_n1_02*(-1-ux)**2 + k2_0_02*ux**2 + k2_1_02*(1-ux)**2
    k_212 = k2_n1_12*(-1-ux)**2 + k2_0_12*ux**2 + k2_1_12*(1-ux)**2
    k_222 = k2_n1_22*(-1-ux)**2 + k2_0_22*ux**2 + k2_1_22*(1-ux)**2

    return ( k_000, k_001, k_002, k_010, k_011, k_012, k_020, k_021, k_022,
             k_100, k_101, k_102, k_110, k_111, k_112, k_120, k_121, k_122,
             k_200, k_201, k_202, k_210, k_211, k_212, k_220, k_221, k_222)
